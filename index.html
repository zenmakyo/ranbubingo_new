<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ビンゴ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background-color: #8A9A5B; /* 深抹茶色 */
      font-family: sans-serif;
    }
    h1 {
      text-align: center;
      font-size: 6vmin;
      color: white;
      margin: 1em 0 0.5em;
    }
    table {
      width: 90vmin;
      height: 90vmin;
      margin: 1vmin auto;
      border-collapse: collapse;
      table-layout: fixed;
      background-color: white;
    }
    td {
      border: 2px solid #555;
      text-align: center;
      vertical-align: middle;
      position: relative;
    }
    .cell-input {
      width: 85%;
      height: 85%;
      font-size: 2vmin;
      box-sizing: border-box;
      resize: none;
      overflow-wrap: break-word;
      white-space: normal;
      padding: 0.2em;
      margin: auto;
      display: block;
      text-align: center;
    }
    .center-cell {
      font-size: 3vmin;
    }
    .usedDefault {
      background-color: #ccc;
    }
    .rainbow-bg {
      background: linear-gradient(135deg, red, orange, yellow, green, cyan, blue, violet);
      color: white;
    }
    .suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #aaa;
      z-index: 10;
      max-height: 120px;
      overflow-y: auto;
    }
    .suggestion-item {
      padding: 4px;
      cursor: pointer;
    }
    .suggestion-item:hover {
      background: #eee;
    }
    .controls {
      text-align: center;
      margin: 15px auto;
    }
    .controls button {
      font-size: 3vmin;
      margin: 0 1.5em;
      padding: 0.6em 2em;
      border-radius: 8px;
      border: none;
      background: #2e4e1e;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1>ビンゴ</h1>

<table id="bingo"></table>

<div class="controls">
  <button onclick="fillRandom()">ランダム配置</button>
  <button onclick="resetBoard()">リセット</button>
</div>

<script>
  const words = [
    "富士山", "桜", "忍者", "寿司", "着物", "侍", "歌舞伎", "温泉", "神社", "祭り",
    "畳", "茶道", "盆栽", "和菓子", "折り紙", "刀", "花火", "餅", "縁側", "こたつ",
    "おにぎり", "味噌汁", "浮世絵", "将軍", "抹茶"
  ];

  const rainbowWords = ["富士山", "桜", "忍者", "寿司"];
  const table = document.getElementById("bingo");

  for (let i = 0; i < 5; i++) {
    const row = document.createElement("tr");
    for (let j = 0; j < 5; j++) {
      const td = document.createElement("td");

      if (i === 2 && j === 2) {
        td.innerHTML = '<div class="center-cell">⭐</div>';
      } else {
        const input = document.createElement("textarea");
        input.className = "cell-input";
        input.placeholder = "未選択";
        input.rows = 1;

        const suggestionBox = document.createElement("div");
        suggestionBox.className = "suggestions";
        suggestionBox.style.display = "none";

        function showSuggestions(val) {
          suggestionBox.innerHTML = "";
          const filtered = words.filter(w => w.toLowerCase().includes(val.toLowerCase()));
          if (filtered.length) {
            filtered.forEach(w => {
              const item = document.createElement("div");
              item.className = "suggestion-item";
              item.textContent = w;
              item.onclick = () => {
                input.value = w;
                suggestionBox.style.display = "none";
                updateCellColor(td, w);
              };
              suggestionBox.appendChild(item);
            });
            suggestionBox.style.display = "block";
          } else {
            suggestionBox.style.display = "none";
          }
        }

        input.addEventListener("input", () => {
          showSuggestions(input.value);
        });

        input.addEventListener("focus", () => {
          showSuggestions(input.value);
        });

        input.addEventListener("blur", () => {
          setTimeout(() => {
            suggestionBox.style.display = "none";
            const value = input.value.trim();
            if (value && !words.includes(value)) {
              alert("そのワードはありません");
              input.value = "";
              td.className = "";
            } else {
              updateCellColor(td, value);
            }
          }, 200);
        });

        td.appendChild(input);
        td.appendChild(suggestionBox);
      }

      row.appendChild(td);
    }
    table.appendChild(row);
  }

  function updateCellColor(td, word) {
    td.className = rainbowWords.includes(word) ? "rainbow-bg" : "usedDefault";
  }

  function getAllInputs() {
    return Array.from(document.querySelectorAll(".cell-input"));
  }

  function fillRandom() {
    const pool = [...words];
    shuffle(pool);
    getAllInputs().forEach((input, i) => {
      const word = pool[i] || "";
      input.value = word;
      updateCellColor(input.parentElement, word);
    });
  }

  function resetBoard() {
    getAllInputs().forEach(input => {
      input.value = "";
      input.parentElement.className = "";
    });
  }

  function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }
</script>

</body>
</html>
