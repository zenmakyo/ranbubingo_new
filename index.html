<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ãƒ“ãƒ³ã‚´ï¼ˆè™¹è‰²ãƒ¯ãƒ¼ãƒ‰å¯¾å¿œï¼‰</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #d6e5b0;
      margin: 0;
      padding: 1em;
      text-align: center;
    }
    table {
      border-collapse: collapse;
      margin: auto;
      width: 90vw;
      max-width: 500px;
      table-layout: fixed;
    }
    td {
      border: 2px solid #333;
      width: 20%;
      height: 0;
      padding-bottom: 20%;
      position: relative;
      background-color: white;
    }
    .center-free {
      background-color: gold;
      height: 0;
      padding-bottom: 20%;
      position: relative;
    }
    .input-wrapper {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 5%;
      box-sizing: border-box;
    }
    textarea.cellInput {
      width: 100%;
      height: 100%;
      font-size: 1em;
      text-align: center;
      border: 1px solid #aaa;
      border-radius: 6px;
      resize: none;
      overflow: hidden;
      white-space: pre-wrap;
      word-wrap: break-word;
      box-sizing: border-box;
      padding: 0.2em;
    }

    /* ğŸ¨ ã‚«ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ */
    td.usedDefault { background-color: #e0e0e0; } /* åŸºæœ¬ã‚°ãƒ¬ãƒ¼ */
    td.usedRainbow1 { background-color: #ff9999; } /* èµ¤ */
    td.usedRainbow2 { background-color: #ffcc99; } /* æ©™ */
    td.usedRainbow3 { background-color: #ffff99; } /* é»„ */
    td.usedRainbow4 { background-color: #ccff99; } /* ç·‘ */
    td.usedRainbow5 { background-color: #99ffff; } /* æ°´è‰² */
    td.usedRainbow6 { background-color: #99ccff; } /* é’ */
    td.usedRainbow7 { background-color: #cc99ff; } /* ç´« */

    .suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      background: white;
      border: 1px solid #ccc;
      max-height: 100px;
      overflow-y: auto;
      z-index: 10;
      display: none;
    }
    .suggestions div {
      padding: 6px;
      cursor: pointer;
      text-align: left;
    }
    .suggestions div:hover {
      background-color: #eee;
    }
    .button-row {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
    }
    #randomBtn { background-color: #88a05f; }
    #resetBtn { background-color: #c75b4a; }
    #randomBtn:hover { background-color: #7a9155; }
    #resetBtn:hover { background-color: #b04e3f; }
  </style>
</head>
<body>
  <h2>ãƒ“ãƒ³ã‚´ï¼ˆè™¹è‰²ãƒ¯ãƒ¼ãƒ‰å¯¾å¿œï¼‰</h2>
  <table id="bingo"><tbody></tbody></table>
  <div class="button-row">
    <button id="randomBtn">ãƒ©ãƒ³ãƒ€ãƒ é…ç½®</button>
    <button id="resetBtn">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>

  <script>
    // ğŸ“ ç·¨é›†ã§ãã‚‹å˜èªãƒªã‚¹ãƒˆ
    const words = [
      "ã‚Šã‚“ã”", "ãƒãƒŠãƒŠ", "ã¿ã‹ã‚“", "ã¶ã©ã†", "ã™ã„ã‹", "ã‚‚ã‚‚", "ãƒ‘ã‚¤ãƒŠãƒƒãƒ—ãƒ«", "ã‚­ã‚¦ã‚¤", "ãƒ¬ãƒ¢ãƒ³", "ãƒ¡ãƒ­ãƒ³",
      "ãªã—", "ã•ãã‚‰ã‚“ã¼", "ã‚°ãƒ¬ãƒ¼ãƒ—ãƒ•ãƒ«ãƒ¼ãƒ„", "ãƒ–ãƒ«ãƒ¼ãƒ™ãƒªãƒ¼", "ã‚¹ãƒˆãƒ­ãƒ™ãƒªãƒ¼", "ãƒãƒ³ã‚´ãƒ¼", "ãƒ‰ãƒªã‚¢ãƒ³",
      "ãƒ©ã‚¤ãƒ", "ãƒ‘ãƒƒã‚·ãƒ§ãƒ³ãƒ•ãƒ«ãƒ¼ãƒ„", "ã‚¢ãƒœã‚«ãƒ‰", "ãƒ©ã‚ºãƒ™ãƒªãƒ¼", "ã‚ªãƒ¬ãƒ³ã‚¸", "ãƒãƒ¼ãƒ–ãƒ«", "ã‚«ã‚­", "ã‚¤ãƒã‚¸ã‚¯"
    ];

    // ğŸŒˆ è™¹è‰²ã«ãªã‚‹ç‰¹åˆ¥ãªå˜èª
    const rainbowWords = ["ãƒãƒŠãƒŠ", "ã™ã„ã‹", "ã‚­ã‚¦ã‚¤", "ãƒ–ãƒ«ãƒ¼ãƒ™ãƒªãƒ¼", "ãƒãƒ³ã‚´ãƒ¼", "ãƒ¬ãƒ¢ãƒ³", "ã•ãã‚‰ã‚“ã¼"];

    // ğŸŒˆ è‰²ã‚’é †ç•ªã«ä½¿ã†ãŸã‚ã®é…åˆ—
    const rainbowClasses = [
      "usedRainbow1", "usedRainbow2", "usedRainbow3",
      "usedRainbow4", "usedRainbow5", "usedRainbow6", "usedRainbow7"
    ];
    let rainbowIndex = 0;

    const usedWords = new Set();
    const inputs = [];
    const table = document.querySelector("#bingo tbody");

    for (let i = 0; i < 5; i++) {
      const tr = document.createElement("tr");
      for (let j = 0; j < 5; j++) {
        const td = document.createElement("td");

        if (i === 2 && j === 2) {
          td.className = "center-free";
          const wrapper = document.createElement("div");
          wrapper.className = "input-wrapper";
          const star = document.createElement("div");
          star.textContent = "â­ï¸";
          star.style.fontSize = "2em";
          wrapper.appendChild(star);
          td.appendChild(wrapper);
          tr.appendChild(td);
          continue;
        }

        const wrapper = document.createElement("div");
        wrapper.className = "input-wrapper";

        const input = document.createElement("textarea");
        input.className = "cellInput";
        input.placeholder = "æœªé¸æŠ";
        input.rows = 1;

        const suggestionBox = document.createElement("div");
        suggestionBox.className = "suggestions";

        const updateSuggestions = () => {
          const value = input.value.trim();
          suggestionBox.innerHTML = "";
          const filtered = words.filter(word =>
            word.includes(value) && !usedWords.has(word)
          );
          if (filtered.length === 0) {
            suggestionBox.style.display = "none";
            return;
          }
          filtered.forEach(word => {
            const div = document.createElement("div");
            div.textContent = word;
            div.onclick = () => {
              input.value = word;
              input.title = word;
              suggestionBox.style.display = "none";
              if (usedWords.has(word)) {
                alert("ãã®å˜èªã¯ã™ã§ã«ä½¿ã‚ã‚Œã¦ã„ã¾ã™");
                input.value = "";
                td.className = "";
                return;
              }
              if (rainbowWords.includes(word)) {
                td.className = rainbowClasses[rainbowIndex % rainbowClasses.length];
                rainbowIndex++;
              } else {
                td.className = "usedDefault";
              }
              usedWords.add(word);
            };
            suggestionBox.appendChild(div);
          });
          suggestionBox.style.display = "block";
        };

        input.addEventListener("input", updateSuggestions);
        input.addEventListener("focus", updateSuggestions);
        input.addEventListener("blur", () => {
          setTimeout(() => suggestionBox.style.display = "none", 200);
        });

        wrapper.appendChild(input);
        wrapper.appendChild(suggestionBox);
        td.appendChild(wrapper);
        tr.appendChild(td);
        inputs.push({ input, td });
      }
      table.appendChild(tr);
    }

    document.getElementById("randomBtn").onclick = () => {
      const available = words.filter(w => !usedWords.has(w));
      const emptyCells = inputs.filter(({ input }) => input.value === "");
      if (available.length < emptyCells.length) {
        alert("å˜èªãŒè¶³ã‚Šã¾ã›ã‚“");
        return;
      }
      const shuffled = available.sort(() => 0.5 - Math.random());
      emptyCells.forEach(({ input, td }, idx) => {
        const word = shuffled[idx];
        input.value = word;
        input.title = word;
        if (rainbowWords.includes(word)) {
          td.className = rainbowClasses[rainbowIndex % rainbowClasses.length];
          rainbowIndex++;
        } else {
          td.className = "usedDefault";
        }
        usedWords.add(word);
      });
    };

    document.getElementById("resetBtn").onclick = () => {
      inputs.forEach(({ input, td }) => {
        input.value = "";
        input.title = "";
        td.className = "";
      });
      usedWords.clear();
      rainbowIndex = 0;
    };
  </script>
</body>
</html>
