<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ビンゴ（矢印が収まる入力補完）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 10px;
    }

    table {
      width: 90vw;
      max-width: 600px;
      margin: 0 auto;
      border-collapse: collapse;
      table-layout: fixed;
    }

    td {
      width: 20%;
      padding: 0;
      aspect-ratio: 1 / 1;
      border: 2px solid #333;
      vertical-align: middle;
      position: relative;
    }

    .input-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
    }

    input.cellInput {
      width: 90%;
      height: 60%;
      font-size: clamp(14px, 3.5vw, 18px);
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
      appearance: auto;
    }

    input.cellInput:focus {
      outline: none;
      background-color: #fffde7;
    }

    td.usedA {
      background-color: #90caf9;
    }

    td.usedB {
      background-color: #e0e0e0;
    }
  </style>
</head>
<body>
  <h2>ビンゴ（矢印も収まる補完付き入力）</h2>

  <table id="bingo">
    <tbody></tbody>
  </table>

  <datalist id="wordList"></datalist>

  <script>
    const words = [
      "りんご", "バナナ", "みかん", "ぶどう", "すいか", "もも", "パイナップル", "キウイ", "レモン", "メロン",
      "なし", "さくらんぼ", "グレープフルーツ", "ブルーベリー", "ストロベリー", "マンゴー", "ドリアン",
      "ライチ", "パッションフルーツ", "アボカド", "ラズベリー", "オレンジ", "ネーブル", "カキ", "イチジク"
    ];

    const specialWords = ["バナナ", "ぶどう", "すいか"];
    const usedWords = new Set();

    const table = document.querySelector("#bingo tbody");
    const datalist = document.getElementById("wordList");

    // datalistに候補を追加
    words.forEach(word => {
      const option = document.createElement("option");
      option.value = word;
      datalist.appendChild(option);
    });

    // セル作成
    for (let i = 0; i < 5; i++) {
      const tr = document.createElement("tr");
      for (let j = 0; j < 5; j++) {
        const td = document.createElement("td");
        const wrapper = document.createElement("div");
        wrapper.className = "input-wrapper";

        const input = document.createElement("input");
        input.type = "text";
        input.setAttribute("list", "wordList");
        input.className = "cellInput";
        input.placeholder = "未選択";

        input.addEventListener("change", () => {
          const val = input.value.trim();
          if (!words.includes(val)) {
            alert("リストにない単語です");
            input.value = "";
            td.className = "";
            return;
          }

          if (usedWords.has(val)) {
            alert("この単語はすでに使用されています");
            input.value = "";
            td.className = "";
            return;
          }

          td.className = specialWords.includes(val) ? "usedA" : "usedB";
          usedWords.add(val);
        });

        wrapper.appendChild(input);
        td.appendChild(wrapper);
        tr.appendChild(td);
      }
      table.appendChild(tr);
    }
  </script>
</body>
</html>
